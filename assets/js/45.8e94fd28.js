(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{321:function(t,s,a){"use strict";a.r(s);var e=a(4),n=Object(e.a)({},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"vscode-snippets-插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vscode-snippets-插件","aria-hidden":"true"}},[t._v("#")]),t._v(" vscode snippets 插件")]),t._v(" "),a("blockquote",[a("p",[t._v("讲解如何创建一个 vscode snippets 插件")])]),t._v(" "),a("h2",{attrs:{id:"snippet"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#snippet","aria-hidden":"true"}},[t._v("#")]),t._v(" snippet")]),t._v(" "),a("p",[t._v("日常工作中经常会遇到重复的代码片段，IDE 提供了 snippet 来实现代码片段复用，参考 "),a("a",{attrs:{href:"https://code.visualstudio.com/docs/editor/userdefinedsnippets",target:"_blank",rel:"noopener noreferrer"}},[t._v("vscode snippet 文档"),a("OutboundLink")],1),t._v("  创建代码片段。核心结构为")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  // 片段的名称\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"For Loop"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    // 触发片段的简写名称  \n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"prefix"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"h"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"h1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    // 片段内容，\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"body"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hello world"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    // 片段描述信息，可选\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"description"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test snippets"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[a("code",[t._v("body")]),t._v(" 字段常用语法模式为")]),t._v(" "),a("ol",[a("li",[a("p",[a("code",[t._v("$1-n")]),t._v("  tab 占位 ,当输入片段后,利用 "),a("code",[t._v("tab")]),t._v(" 键会切换光标到对应占位位置")]),t._v(" "),a("blockquote",[a("p",[t._v("注意占位符变量只支持数字，"),a("strong",[t._v("$0")]),t._v(" 表示光标最终停留位置")])])]),t._v(" "),a("li",[a("p",[a("code",[t._v("${n: default}")]),t._v(" 占位默认值, 当对应占位符未输入内容时会被 default 替换")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("${n:|1,2,3|}")]),t._v(" 占位选择，切换到对应占位会弹出选择框")])]),t._v(" "),a("li",[a("p",[a("code",[t._v("${name:default}")]),t._v(" 变量，未定义变量默认为 default")]),t._v(" "),a("blockquote",[a("p",[t._v("注意由于变量未设置 default 时会默认为空，再使用片段时若想显示 $ 可采用 "),a("code",[t._v("$$")]),t._v(" 的方式")])])]),t._v(" "),a("li",[a("p",[t._v("内置变量，例如期望占位内容的默认值为剪切板内容，可使用\n"),a("code",[t._v("$CLIPBOARD")]),t._v(" ,或者采用 "),a("code",[t._v("$TM_FILENAME_BASE")]),t._v(" 来将组件名设置为去掉后缀的文件名，常量列表参见 "),a("a",{attrs:{href:"https://code.visualstudio.com/docs/editor/userdefinedsnippets#_variables",target:"_blank",rel:"noopener noreferrer"}},[t._v("Variables"),a("OutboundLink")],1)])]),t._v(" "),a("li",[a("p",[t._v("变量转换,例如想提取 "),a("code",[t._v("$TM_FILENAME")]),t._v(" 的后缀名，可采用 "),a("code",[t._v("${TM_FILENAME/\\(\\\\.\\\\w+)$/$1/}")]),t._v(" 提取文件后缀名，")])])]),t._v(" "),a("p",[t._v("其余更详细语法参见 "),a("a",{attrs:{href:"https://code.visualstudio.com/docs/editor/userdefinedsnippets#_grammar",target:"_blank",rel:"noopener noreferrer"}},[t._v("grammar"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"片段快捷键"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#片段快捷键","aria-hidden":"true"}},[t._v("#")]),t._v(" 片段快捷键")]),t._v(" "),a("p",[t._v("对于反复使用的片段支持快捷键触发，配置格式为")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  // 配置对应快捷键\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"key"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cmd+k 1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"command"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"editor.action.insertSnippet"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"when"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"editorTextFocus"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"args"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     // 快捷键触发的片段 \n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"snippet"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"console.log($1)$0"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("也可将快捷键绑定到申明的代码片段上，修改 "),a("code",[t._v("args")]),t._v(" 配置为")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  // ...\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"args"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"langId"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"csharp"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" // 对应的语言\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"myFavSnippet"')]),t._v(" // 片段的键名\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("详细的语言支持参见 "),a("a",{attrs:{href:"https://code.visualstudio.com/docs/languages/identifiers",target:"_blank",rel:"noopener noreferrer"}},[t._v("language Identifiers"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"项目共享片段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#项目共享片段","aria-hidden":"true"}},[t._v("#")]),t._v(" 项目共享片段")]),t._v(" "),a("p",[t._v("可在特定项目创建复用的片段")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("在项目根目录创建 "),a("code",[t._v(".vscode")]),t._v(" 文件夹")])]),t._v(" "),a("li",[a("p",[t._v("在 "),a("code",[t._v(".vscode")]),t._v(" 文件夹, 添加后缀为 "),a("code",[t._v(".code-snippets")]),t._v(" 的文件，例如 "),a("code",[t._v("test.code-snippets")])])]),t._v(" "),a("li",[a("p",[t._v("在创建的 "),a("code",[t._v("test.code-snippets")]),t._v(" 文件中添加片段")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"test"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"prefix"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"af"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"arrowf"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"body"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"const ${1:func} = () => { $0 }"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"description"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"arrow function"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   // 此处申明对应作用范围\n   "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scope"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"javascript,typescript"')]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("项目中即可使用该片段")])])]),t._v(" "),a("p",[t._v("该功能在版本 1.28 出现，详见 "),a("a",{attrs:{href:"https://code.visualstudio.com/updates/v1_28#_project-level-snippets",target:"_blank",rel:"noopener noreferrer"}},[t._v("project snippets"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"vscode-snippet-插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vscode-snippet-插件","aria-hidden":"true"}},[t._v("#")]),t._v(" vscode snippet 插件")]),t._v(" "),a("p",[t._v("除了本地和项目中配置 snippet,可将 snippet 制作为插件进行分享。\n参考 "),a("a",{attrs:{href:"https://code.visualstudio.com/api/language-extensions/snippet-guide",target:"_blank",rel:"noopener noreferrer"}},[t._v("snippet guide"),a("OutboundLink")],1)]),t._v(" "),a("ol",[a("li",[t._v("在 package.json 中申明插件路径")])]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"contributes"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"snippets"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"language"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"javascript"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         // 这里统一放在 snippets 目录方便组织\n         "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"path"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./snippets/a.json"')]),t._v("\n       "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("在 "),a("code",[t._v("snippets")]),t._v(" 目录创建 "),a("code",[t._v("a.json")]),t._v(" 的 snippet")])]),t._v(" "),a("p",[t._v("然后将整个项目拷贝到 "),a("code",[t._v("~/.vscode/extensions")]),t._v(" ,重启 vscode 即可触发插件的 snippet")]),t._v(" "),a("h3",{attrs:{id:"本地打包和安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#本地打包和安装","aria-hidden":"true"}},[t._v("#")]),t._v(" 本地打包和安装")]),t._v(" "),a("p",[t._v("采用 vsce 将应用打包为 "),a("code",[t._v(".vsix")]),t._v(" 文件，其他可采用 vscode 提供的 cli "),a("code",[t._v("code")]),t._v(" 命令进行安装，开启 code 命令详见 "),a("a",{attrs:{href:"http://blog.zenheart.site/posts/2018-08-28-vscode.html#%E9%85%8D%E7%BD%AE-code-%E5%91%BD%E4%BB%A4",target:"_blank",rel:"noopener noreferrer"}},[t._v("配置 code 命令"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 1. 全局安装 vsce")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -g vsce\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 2. 项目更目录打包插件")]),t._v("\nvsce package\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 3. 使用 code 安装 .vsix 文件")]),t._v("\ncode --install-extension my-extension-0.0.1.vsix\n")])])]),a("h3",{attrs:{id:"发布"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#发布","aria-hidden":"true"}},[t._v("#")]),t._v(" 发布")]),t._v(" "),a("p",[t._v("发布详见 "),a("a",{attrs:{href:"https://code.visualstudio.com/api/working-with-extensions/publishing-extension",target:"_blank",rel:"noopener noreferrer"}},[t._v("Publishing Extensions"),a("OutboundLink")],1),t._v(" 流程类似 npm 包发布")]),t._v(" "),a("h2",{attrs:{id:"snippets-模板扩展"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#snippets-模板扩展","aria-hidden":"true"}},[t._v("#")]),t._v(" snippets 模板扩展")]),t._v(" "),a("p",[t._v("由于 vscode snippets 不支持模板文件，单书写片段过于庞大时，\n需要将模板内容转换为 snippet "),a("code",[t._v("body")]),t._v(" 字段的数组模式。为了简化类似 snippet 的书写流程，可以在 "),a("code",[t._v("body")]),t._v(" 中配置模板文件路径。然后利用\njs 脚本读取路径中的文件内容转换为数组，重新保存即可简化包含大量内容的片段书写")])])},[],!1,null,null,null);s.default=n.exports}}]);